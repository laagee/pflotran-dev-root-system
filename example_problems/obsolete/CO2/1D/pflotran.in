#Description: 1D test problem for mph
#
#MODE RICHARDS
MODE MPHASE
skip
#TRAN 1
CHEMISTRY
PRIMARY_SPECIES
river_c
groundwater_c
plume_c
END
END
noskip
#
#CHECKPOINT 1
#RESTART pflotran.chk4
#UNIFORM_VELOCITY 1.d0 0.d0 0.d0
#NUMERICAL_JACOBIAN
#INEXACT_NEWTON
#
#DEBUG
#MATVIEW_JACOBIAN
#VECVIEW_RESIDUAL
#END
#
GRID
TYPE structured
NXYZ 10  1  1
END
#
ORIGIN 0.d0 0.d0 0.d0
#
NEWTON_SOLVER 
#NO_INFINITY_NORM
#NO_PRINT_CONVERGENCE
#PRINT_DETAILED_CONVERGENCE
END
#
#HDF5 !VELO FLUX
TECP !VELO FLUX
#
DXYZ
1.d0
1.d0
1.d0
#
#  d0[m^2/s] delhaq[kJ/mol]
DIFF  1.D-9       12.6
#
# Richards Equation Pref
#RICH 101325.
#
SATURATION_FUNCTIONS
#id itype swir    sgir    lambda alpha     pcwmax betac pwr
 1  1     0.1471  0.D0    0.7465 4.4317d-4 1.e8   0.d0  1.d0
END

THERMAL_PROPERTIES
#ithm rho    cpr     ckdry cksat tau cdiff   cexp
  1   2.75e3 1000.e0 0.5   0.5   0.5 2.13d-5 1.8
END
#
MATERIALS
#name id icap ithm por  tau permx  permy  permz  permpwr
soil1 1  1    1    0.25 0.5 1.d-13 1.d-12 1.d-12 1.d0
#soil2 2  1    1    0.25 0.5 1.d-13 1.d-13 1.d-13 1.d0
END
#
#
TIME d every 10
100.d0
#
DTST 1.d-2
100. 1.d0
#
REGION all
BLOCK 1 10 1 1 1 1
END

REGION west
BLOCK 1 1 1 1 1 1
FACE west
END

REGION east
BLOCK 10 10 1 1 1 1
FACE east
END

CONDITION west
CLASS flow
TYPE
PRESSURE dirichlet
TEMPERATURE dirichlet
CONCENTRATION dirichlet
END
IPHASE 3
PRESSURE 2.01D7 2.01d7
TEMPERATURE 50.d0 
CONCENTRATION 0.5D0
END

CONDITION east
CLASS flow
TYPE
PRESSURE dirichlet
TEMPERATURE zero_gradient
CONCENTRATION zero_gradient
END
IPHASE 1
PRESSURE 2.0D7 2d7
TEMPERATURE 50.d0 
CONCENTRATION 1.D-6
END

CONDITION initial
CLASS flow
TYPE
PRESSURE dirichlet
TEMPERATURE dirichlet
CONCENTRATION dirichlet
END
IPHASE 3
PRESSURE 2d7 2d7
TEMPERATURE 50.d0 
CONCENTRATION 0.35 
END

# initial condition
INITIAL_CONDITION
FLOW_CONDITION initial
REGION all
END

# west boundary condition
BOUNDARY_CONDITION
FLOW_CONDITION west
REGION west
END

# east boundary condition
BOUNDARY_CONDITION
FLOW_CONDITION east
REGION east
END


STRATA

REGION all

MATERIAL soil1

END


NEWTON_SOLVER FLOW
ATOL 1D-12
RTOL 1D-12
STOL 1D-25
DTOL 1D15
ITOL 1D-8
MAXIT 25
MAXF 100
END
