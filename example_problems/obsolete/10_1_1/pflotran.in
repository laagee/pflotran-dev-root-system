#Description: 1D problem for testing geochemistry
 
MODE RICHARDS

COMPUTE_MASS_BALANCE_NEW

CHEMISTRY
PRIMARY_SPECIES
H+
HCO3-
Ca++
END
SECONDARY_SPECIES
OH-
CO3--
CO2(aq)
CaHCO3+
CaCO3(aq)
END
GAS_SPECIES
CO2(g)
END
MINERALS
Calcite
END
MINERAL_KINETICS
Calcite 1.d-6
END
DATABASE ../../database/hanford.dat
END
#
#CHECKPOINT 1
#RESTART pflotran.chk1

TIMESTEPPER
#MAX_STEPS 5
END

#NUMERICAL_JACOBIAN
#INEXACT_NEWTON
#STATISTICS
#
#CHECKPOINT 50
#WALLCLOCK_STOP 0.05
#
DEBUG
#MATVIEW_JACOBIAN
#VECVIEW_RESIDUAL
#VECVIEW_SOLUTION
END
#
GRID
TYPE structured
NXYZ 10 1 1
DXYZ
1.
1.
1.
END
END
#
NEWTON_SOLVER FLOW
#MATRIX_TYPE MFFD
#PRECONDITIONER_MATRIX_TYPE AIJ
#RTOL 1.d-8
ATOL 1.d-6
NO_INFINITY_NORM
#NO_PRINT_CONVERGENCE
#PRINT_DETAILED_CONVERGENCE
END
#
LINEAR_SOLVER FLOW
#KSP_TYPE FGMRES
#KSP_TYPE PREONLY
#PC_TYPE LU
END
#
LINEAR_SOLVER TRANSPORT
#KSP_TYPE PREONLY
#PC_TYPE LU
END
#
#STATISTICS
#
HDF5 VELO !FLUX
TECPLOT BLOCK VELO !FLUX
#VTK
#
DIFF  1.D-9       12.6
#
SATURATION_FUNCTIONS
#id itype swir   lambda alpha     pcwmax betac pwr
 1  2     0.10   2.67   2.042d-4  1.e8   0.d0  1.d0
END

THERMAL_PROPERTIES
#ithm rho    cpr     ckdry cksat tau cdiff   cexp
  1   2.75e3 1000.e0 0.5   0.5   0.5 2.13d-5 1.8
END
#
MATERIALS
#name   id icap ithm por  tau permx     permy     permz     permpwr
Soil1   1  1    1    0.25 0.5 1.d-12    1.d-12    1.d-13    1.d0
END
#
TIME d every 1
40.
#
#DTST 1.d-6
DTST 1.d-6
#50. 1.0d0 
50. 0.1d0 
#
REGION all
BLOCK 1 10 1 1 1 1
END

REGION West
BLOCK 1 1 1 1 1 1
FACE west
END

REGION East
BLOCK 10 10 1 1 1 1
FACE east
END

skip
FLOW_CONDITION Inlet
TYPE
PRESSURE mass
END
PRESSURE 1.d-3
END

FLOW_CONDITION Outlet
TYPE
PRESSURE mass
END
PRESSURE -1.d-3
END
noskip

FLOW_CONDITION Inlet
TYPE
FLUX neumann
END
FLUX 2.8935185d-7 ! 0.1 m/day pore water
END

FLOW_CONDITION Outlet
TYPE
FLUX neumann
END
FLUX -2.8935185d-7
END

FLOW_CONDITION initial
TYPE
PRESSURE hydrostatic
END
DATUM 0.d0 0.d0 1.d0
PRESSURE 201325.d0
END

TRANSPORT_CONDITION Inlet_c
TYPE neumann
CONSTRAINT_LIST
0.d0 Inlet
END
END
TRANSPORT_CONDITION initial_c
TYPE neumann
CONSTRAINT_LIST
0.d0 initial
END
END

CONSTRAINT initial
CONCENTRATIONS
H+ 8 pH
HCO3- 1.d-3 GAS CO2(g)
Ca++ 1.d-5 MINERAL Calcite
END
MINERALS
Calcite 0.001 1.d0
END
END

CONSTRAINT Inlet
CONCENTRATIONS
H+  6 pH
HCO3- 1.d-3 T
Ca++ 1.d-5 T
END
END

BOUNDARY_CONDITION inlet
FLOW_CONDITION Inlet
TRANSPORT_CONDITION Inlet_c
REGION West
END

BOUNDARY_CONDITION outlet
FLOW_CONDITION Outlet
TRANSPORT_CONDITION initial_c
REGION East
END

skip
SOURCE_SINK
FLOW_CONDITION Inlet
TRANSPORT_CONDITION Inlet_c
REGION West
END

SOURCE_SINK
FLOW_CONDITION Outlet
TRANSPORT_CONDITION initial_c
REGION East
END
noskip

INITIAL_CONDITION
FLOW_CONDITION initial
TRANSPORT_CONDITION initial_c
REGION all
END

STRATA
MATERIAL Soil1
REGION all
END

