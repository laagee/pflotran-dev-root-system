!Description! BRAGFLO Case #5 simulation...or at least an attempt at it....

!=========================== flow mode ========================================
MODE GENERAL MORE
!  WINDOW_EPSILON 1.d-4
  ISOTHERMAL
  TWO_PHASE_ENERGY_DOF TEMPERATURE  
  GAS_COMPONENT_FORMULA_WEIGHT 2.01588D0 ! kg/kmol
  MAXIMUM_PRESSURE_CHANGE 1.0D6
/

REGRESSION
  CELLS_PER_PROCESS 10
  CELLS
    110
    111
    112
    113
    114
    115
  /
END
!=========================== discretization ===================================
GRID
  TYPE structured
  NXYZ 11 1 21
  DXYZ
    0.5d0 10*1.d0
    1.d0 
    21*1.d0
  /
/

!=========================== solver options ===================================
TIMESTEPPER FLOW
!  DT_FACTOR 2.d0 1.8d0 1.6d0 1.4d0 1.2d0 1.d0 0.8d0 0.6d0 0.4d0
END

NEWTON_SOLVER FLOW

/

LINEAR_SOLVER FLOW
  SOLVER DIRECT
/

!=========================== fluid properties =================================
FLUID_PROPERTY
  DIFFUSION_COEFFICIENT 1.d-9
/

EOS WATER
  DENSITY EXPONENTIAL 996.629 101325.d0 4.45d-10
  VISCOSITY CONSTANT 8.5077d-4
  ENTHALPY CONSTANT 1.8890d6
/

EOS GAS
  VISCOSITY CONSTANT 9.0829d-6
/

!=========================== material properties ==============================
MATERIAL_PROPERTY soil
  ID 1
  CHARACTERISTIC_CURVES cc1
  POROSITY 0.45
  TORTUOSITY 1.0
  ROCK_DENSITY 2650.d0
  THERMAL_CONDUCTIVITY_DRY 0.5
  THERMAL_CONDUCTIVITY_WET 2.0
  HEAT_CAPACITY 830.0
  SOIL_COMPRESSIBILITY_FUNCTION BRAGFLO
  SOIL_COMPRESSIBILITY 1.d-8
  SOIL_REFERENCE_PRESSURE 101325.d0
  PERMEABILITY
    PERM_ISO 1.d-17
  /
/

!=========================== saturation functions =============================
CHARACTERISTIC_CURVES cc1
#  TEST
  SATURATION_FUNCTION BROOKS_COREY
    LIQUID_RESIDUAL_SATURATION 0.2d0
    LAMBDA 0.7d0
    ALPHA 9.869d-6
    MAX_CAPILLARY_PRESSURE 1.d8
    SMOOTH
  /
  PERMEABILITY_FUNCTION BURDINE
    PHASE LIQUID
    LIQUID_RESIDUAL_SATURATION 0.2d0
    LAMBDA 0.7d0
  /
  PERMEABILITY_FUNCTION BURDINE_BC_GAS
    PHASE GAS
    LIQUID_RESIDUAL_SATURATION 0.2d0
    GAS_RESIDUAL_SATURATION 1.d-5
    LAMBDA 0.7d0
  /
/

!=========================== output options ===================================
OUTPUT
!  PERIODIC_OBSERVATION TIMESTEP 1
  TIMES s 1.d6 1.d7 1.d8
  FORMAT HDF5
  VARIABLES
    LIQUID_PRESSURE
    GAS_PRESSURE
    GAS_SATURATION
  /
/

!=========================== times ============================================
TIME
  FINAL_TIME 5.d8 s ! 0.317... y
  INITIAL_TIMESTEP_SIZE 1.d-1 d
  MAXIMUM_TIMESTEP_SIZE 1.d9 s
/

!=========================== regions ==========================================
REGION all
  COORDINATES
    0.d0 0.d0 0.d0
    10.5d0 1.d0 21.d0
  /
/

REGION top
  FACE top
  COORDINATES
    0.d0 0.d0 21.d0
    10.5d0 1.d0 21.d0
  /
/

REGION injection_point
  BLOCK 1 1 1 1 11 11
/

REGION 1
  BLOCK 1 11 1 1 1 1
END

REGION 2
  BLOCK 1 11 1 1 2 2
END

REGION 3
  BLOCK 1 11 1 1 3 3
END

REGION 4
  BLOCK 1 11 1 1 4 4
END

REGION 5
  BLOCK 1 11 1 1 5 5
END

REGION 6
  BLOCK 1 11 1 1 6 6
END

REGION 7
  BLOCK 1 11 1 1 7 7
END

REGION 8
  BLOCK 1 11 1 1 8 8
END

REGION 9
  BLOCK 1 11 1 1 9 9
END

REGION 10
  BLOCK 1 11 1 1 10 10
END

REGION 11
  BLOCK 1 11 1 1 11 11
END

REGION 12
  BLOCK 1 11 1 1 12 12
END

REGION 13
  BLOCK 1 11 1 1 13 13
END

REGION 14
  BLOCK 1 11 1 1 14 14
END

REGION 15
  BLOCK 1 11 1 1 15 15
END

REGION 16
  BLOCK 1 11 1 1 16 16
END

REGION 17
  BLOCK 1 11 1 1 17 17
END

REGION 18
  BLOCK 1 11 1 1 18 18
END

REGION 19
  BLOCK 1 11 1 1 19 19
END

REGION 20
  BLOCK 1 11 1 1 20 20
END

REGION 21
  BLOCK 1 11 1 1 21 21
END

!=========================== observation points ===============================
skip
OBSERVATION 
  REGION injection_point
/
noskip
!=========================== flow conditions ==================================
FLOW_CONDITION 1
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 4.08320E+06
  LIQUID_SATURATION 9.999900e-01
  TEMPERATURE 25.d0
END

FLOW_CONDITION 2
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 4.07340E+06
  LIQUID_SATURATION 9.999900e-01
  TEMPERATURE 25.d0
END

FLOW_CONDITION 3
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 4.06360E+06
  LIQUID_SATURATION 9.999900e-01
  TEMPERATURE 25.d0
END

FLOW_CONDITION 4
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 4.05380E+06
  LIQUID_SATURATION 9.999900e-01
  TEMPERATURE 25.d0
END

FLOW_CONDITION 5
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 4.04400E+06
  LIQUID_SATURATION 9.999900e-01
  TEMPERATURE 25.d0
END

FLOW_CONDITION 6
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 4.03420E+06
  LIQUID_SATURATION 9.999900e-01
  TEMPERATURE 25.d0
END

FLOW_CONDITION 7
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 4.02440E+06
  LIQUID_SATURATION 9.999900e-01
  TEMPERATURE 25.d0
END

FLOW_CONDITION 8
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 4.01470E+06
  LIQUID_SATURATION 9.999900e-01
  TEMPERATURE 25.d0
END

FLOW_CONDITION 9
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 4.00490E+06
  LIQUID_SATURATION 9.999900e-01
  TEMPERATURE 25.d0
END

FLOW_CONDITION 10
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 3.99510E+06
  LIQUID_SATURATION 9.999900e-01
  TEMPERATURE 25.d0
END

FLOW_CONDITION 11
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 3.98530E+06
  LIQUID_SATURATION 9.999900e-01
  TEMPERATURE 25.d0
END

FLOW_CONDITION 12
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 3.97552E+06
  LIQUID_SATURATION 9.999800e-01
  TEMPERATURE 25.d0
END

FLOW_CONDITION 13
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 3.97054E+06
  LIQUID_SATURATION 9.972900e-01
  TEMPERATURE 25.d0
END

FLOW_CONDITION 14
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 3.97049E+06
  LIQUID_SATURATION 9.919200e-01
  TEMPERATURE 25.d0
END

FLOW_CONDITION 15
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 3.97045E+06
  LIQUID_SATURATION 9.866300e-01
  TEMPERATURE 25.d0
END

FLOW_CONDITION 16
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 3.97040E+06
  LIQUID_SATURATION 9.814300e-01
  TEMPERATURE 25.d0
END

FLOW_CONDITION 17
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 3.97036E+06
  LIQUID_SATURATION 9.763100e-01
  TEMPERATURE 25.d0
END

FLOW_CONDITION 18
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 3.97032E+06
  LIQUID_SATURATION 9.712700e-01
  TEMPERATURE 25.d0
END

FLOW_CONDITION 19
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 3.97027E+06
  LIQUID_SATURATION 9.663100e-01
  TEMPERATURE 25.d0
END

FLOW_CONDITION 20
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 3.97022E+06
  LIQUID_SATURATION 9.614300e-01
  TEMPERATURE 25.d0
END

FLOW_CONDITION 21
  TYPE

    GAS_PRESSURE dirichlet
    LIQUID_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 3.97018E+06
  LIQUID_SATURATION 9.566200e-01
  TEMPERATURE 25.d0
END


skip
FLOW_CONDITION initial
  TYPE
    GAS_PRESSURE dirichlet
    GAS_SATURATION dirichlet
    TEMPERATURE dirichlet
  /
  GAS_PRESSURE 3.0783d6
  GAS_SATURATION 1.d-4
  TEMPERATURE 25.d0
/
noskip

skip
FLOW_CONDITION well
  TYPE
    RATE mass_rate
  /
  RATE 0.d0 1.d-5 0.d0
/
noskip

!=========================== condition couplers ===============================
INITIAL_CONDITION
  FLOW_CONDITION 1
  REGION 1
END

INITIAL_CONDITION
  FLOW_CONDITION 2
  REGION 2
END

INITIAL_CONDITION
  FLOW_CONDITION 3
  REGION 3
END

INITIAL_CONDITION
  FLOW_CONDITION 4
  REGION 4
END

INITIAL_CONDITION
  FLOW_CONDITION 5
  REGION 5
END

INITIAL_CONDITION
  FLOW_CONDITION 6
  REGION 6
END

INITIAL_CONDITION
  FLOW_CONDITION 7
  REGION 7
END

INITIAL_CONDITION
  FLOW_CONDITION 8
  REGION 8
END

INITIAL_CONDITION
  FLOW_CONDITION 9
  REGION 9
END

INITIAL_CONDITION
  FLOW_CONDITION 10
  REGION 10
END

INITIAL_CONDITION
  FLOW_CONDITION 11
  REGION 11
END

INITIAL_CONDITION
  FLOW_CONDITION 12
  REGION 12
END

INITIAL_CONDITION
  FLOW_CONDITION 13
  REGION 13
END

INITIAL_CONDITION
  FLOW_CONDITION 14
  REGION 14
END

INITIAL_CONDITION
  FLOW_CONDITION 15
  REGION 15
END

INITIAL_CONDITION
  FLOW_CONDITION 16
  REGION 16
END

INITIAL_CONDITION
  FLOW_CONDITION 17
  REGION 17
END

INITIAL_CONDITION
  FLOW_CONDITION 18
  REGION 18
END

INITIAL_CONDITION
  FLOW_CONDITION 19
  REGION 19
END

INITIAL_CONDITION
  FLOW_CONDITION 20
  REGION 20
END

INITIAL_CONDITION
  FLOW_CONDITION 21
  REGION 21
END
skip
BOUNDARY_CONDITION
  FLOW_CONDITION 21
  REGION 21
END
noskip
skip
INITIAL_CONDITION top
  FLOW_CONDITION initial
  REGION top
/
noskip

skip
SOURCE_SINK well
  FLOW_CONDITION well
  REGION injection_point
/
noskip

SOURCE_SINK_SANDBOX
  WIPP-GAS_GENERATION
    REGION injection_point
    INUNDATED_CORROSION_RATE 3d-7
    INUNDATED_DEGRADATION_RATE 1.5d-6
    HUMID_CORROSION_FACTOR 1.0d-3
    HUMID_DEGREDATION_FACTOR 0.2d0
    H2_FE_RATIO 1.3081d0
    H2_CH2O_RATIO 1.1100d0
  /
/

!=========================== stratigraphy couplers ============================
STRATA
  MATERIAL soil
  REGION all
/

